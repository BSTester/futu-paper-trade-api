# å¯Œé€”æ¨¡æ‹Ÿäº¤æ˜“ - æ¥å£ç»Ÿä¸€è¯´æ˜

## é‡è¦æ›´æ–° âš ï¸

ç»è¿‡å®é™…æµ‹è¯•éªŒè¯ï¼Œ**æ‰€æœ‰å¸‚åœºç»Ÿä¸€ä½¿ç”¨ç›¸åŒçš„å–å‡ºå‚æ•°**ï¼

---

## ç»Ÿä¸€çš„äº¤æ˜“å‚æ•°

### ä¹°å…¥å’Œå–å‡ºå‚æ•°

**æ‰€æœ‰å¸‚åœºï¼ˆç¾è‚¡ã€Aè‚¡ã€æ¸¯è‚¡ï¼‰ç»Ÿä¸€ä½¿ç”¨**ï¼š
- **ä¹°å…¥**: `side=B` (Bid/Buy)
- **å–å‡º**: `side=A` (Ask/Sell)

### æ¥å£å·®å¼‚

è™½ç„¶å‚æ•°ç»Ÿä¸€ï¼Œä½†ä¸åŒå¸‚åœºä½¿ç”¨ä¸åŒçš„æ¥å£ï¼š

| å¸‚åœº | ä¸‹å•æ¥å£ | æ’¤å•æ¥å£ | ç‰¹æ®Šå‚æ•° |
|------|---------|---------|---------|
| **ç¾è‚¡** | `inputIntegratedOrder` | `cancelIntegratedOrder` | `period_type` |
| **Aè‚¡** | `inputOrder` | `cancelOrder` | `security_type` |
| **æ¸¯è‚¡** | `inputOrder` | `cancelOrder` | `security_type` |

---

## ä¸€ã€ç¾è‚¡æ¥å£

### 1. ç¾è‚¡ä¸‹å•
```
POST /paper-trade/common-api?_m=inputIntegratedOrder

å‚æ•°:
{
  "account_id": "16992013",
  "market_type": 100,
  "price": "202.49",
  "side": "B",              # B=ä¹°å…¥, A=å–å‡º
  "quantity": 1,
  "order_type": 1,
  "security_id": "202597",
  "period_type": 2          # 1=ç›˜å‰, 2=æ­£å¸¸, 3=ç›˜å
}
```

### 2. ç¾è‚¡æ’¤å•
```
POST /paper-trade/common-api?_m=cancelIntegratedOrder

å‚æ•°:
{
  "account_id": "16992013",
  "market_type": 100,
  "order_id": "6363648"
}
```

---

## äºŒã€Aè‚¡/æ¸¯è‚¡æ¥å£

### 1. Aè‚¡/æ¸¯è‚¡ä¸‹å•
```
POST /paper-trade/common-api?_m=inputOrder

å‚æ•°:
{
  "account_id": "3182575",
  "security_id": "64123863331268",
  "market_type": 3,         # 1=æ¸¯è‚¡, 3=Aè‚¡
  "side": "B",              # B=ä¹°å…¥, A=å–å‡º
  "order_type": 1,
  "price": "5.610",
  "quantity": 100,
  "security_type": 1
}
```

### 2. Aè‚¡/æ¸¯è‚¡æ’¤å•
```
POST /paper-trade/common-api?_m=cancelOrder

å‚æ•°:
{
  "account_id": "3182575",
  "order_id": "123456789"
}
```

---

## ä¸‰ã€Pythonå®ç°

### é…ç½®æ–‡ä»¶ (config.py)

```python
# è®¢å•æ–¹å‘ï¼ˆæ‰€æœ‰å¸‚åœºç»Ÿä¸€ï¼‰
ORDER_SIDE = {
    "BUY": "B",   # ä¹°å…¥
    "SELL": "A",  # å–å‡ºï¼ˆæ‰€æœ‰å¸‚åœºç»Ÿä¸€ä½¿ç”¨Aï¼‰
}
```

### ä¸‹å•æ–¹æ³•

```python
async def place_order(self, trade_request: TradeRequest) -> TradeResponse:
    """ä¸‹å•äº¤æ˜“ï¼ˆæ‰€æœ‰å¸‚åœºç»Ÿä¸€å‚æ•°ï¼‰"""
    
    # æ‰€æœ‰å¸‚åœºç»Ÿä¸€ä½¿ç”¨ï¼šB=ä¹°å…¥, A=å–å‡º
    side_code = ORDER_SIDE[side]
    
    if market_type == "US":
        # ç¾è‚¡ä½¿ç”¨ inputIntegratedOrder
        params = {"_m": "inputIntegratedOrder"}
        order_data = {
            "account_id": str(account_id),
            "market_type": 100,
            "side": side_code,  # Bæˆ–A
            "period_type": 2,
            ...
        }
    else:
        # Aè‚¡/æ¸¯è‚¡ä½¿ç”¨ inputOrder
        params = {"_m": "inputOrder"}
        order_data = {
            "account_id": str(account_id),
            "market_type": market_type_code,
            "side": side_code,  # Bæˆ–A
            "security_type": 1,
            ...
        }
    
    data = await self._request("POST", url, params=params, json=order_data)
    ...
```

---

## å››ã€ä½¿ç”¨ç¤ºä¾‹

### ç»Ÿä¸€çš„APIè°ƒç”¨

æ‰€æœ‰å¸‚åœºä½¿ç”¨å®Œå…¨ç›¸åŒçš„è°ƒç”¨æ–¹å¼ï¼š

```python
from futu_client import FutuClient
from models import TradeRequest

client = FutuClient()

# ç¾è‚¡ä¹°å…¥
result = await client.place_order(TradeRequest(
    stock_code="AAPL",
    market_type="US",
    side="BUY",      # è½¬æ¢ä¸º side=B
    order_type="LIMIT",
    price=180.0,
    quantity=10,
    security_type="STOCK"
))

# ç¾è‚¡å–å‡º
result = await client.place_order(TradeRequest(
    stock_code="AAPL",
    market_type="US",
    side="SELL",     # è½¬æ¢ä¸º side=A
    order_type="LIMIT",
    price=185.0,
    quantity=10,
    security_type="STOCK"
))

# Aè‚¡ä¹°å…¥
result = await client.place_order(TradeRequest(
    stock_code="601988",
    market_type="CN",
    side="BUY",      # è½¬æ¢ä¸º side=B
    order_type="LIMIT",
    price=5.61,
    quantity=100,
    security_type="STOCK"
))

# Aè‚¡å–å‡º
result = await client.place_order(TradeRequest(
    stock_code="601988",
    market_type="CN",
    side="SELL",     # è½¬æ¢ä¸º side=A
    order_type="LIMIT",
    price=5.65,
    quantity=100,
    security_type="STOCK"
))
```

---

## äº”ã€å‚æ•°å¯¹ç…§è¡¨

### ç»Ÿä¸€çš„äº¤æ˜“å‚æ•°

| æ“ä½œ | æ‰€æœ‰å¸‚åœº | è¯´æ˜ |
|------|---------|------|
| ä¹°å…¥ | `side=B` | Bid/Buy |
| å–å‡º | `side=A` | Ask/Sell |

### æ¥å£å·®å¼‚

| åŠŸèƒ½ | ç¾è‚¡ | Aè‚¡/æ¸¯è‚¡ |
|------|------|---------|
| ä¸‹å•æ¥å£ | `inputIntegratedOrder` | `inputOrder` |
| æ’¤å•æ¥å£ | `cancelIntegratedOrder` | `cancelOrder` |
| ç‰¹æ®Šå‚æ•° | `period_type` | `security_type` |
| æ’¤å•å‚æ•° | éœ€è¦ `market_type` | ä¸éœ€è¦ |

---

## å…­ã€é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®

```env
# å¯Œé€”Cookie
FUTU_COOKIE=your_cookie_here

# å„å¸‚åœºè´¦æˆ·ID
ACCOUNT_ID_US=16992013      # ç¾è‚¡æ¨¡æ‹Ÿè´¦æˆ·
ACCOUNT_ID_HK=9393          # æ¸¯è‚¡æ¨¡æ‹Ÿè´¦æˆ·
ACCOUNT_ID_CN=3182575       # Aè‚¡æ¨¡æ‹Ÿè´¦æˆ·
```

**æ³¨æ„**: å·²ç§»é™¤ `ACCOUNT_ID` é»˜è®¤è´¦æˆ·é…ç½®ï¼Œå¿…é¡»ä¸ºæ¯ä¸ªå¸‚åœºå•ç‹¬é…ç½®è´¦æˆ·IDã€‚

---

## ä¸ƒã€ä¼˜åŠ¿

### 1. å‚æ•°ç»Ÿä¸€
- æ‰€æœ‰å¸‚åœºä½¿ç”¨ç›¸åŒçš„ä¹°å–å‚æ•°
- é™ä½å­¦ä¹ æˆæœ¬
- å‡å°‘é”™è¯¯

### 2. æ¥å£é€æ˜
- å®¢æˆ·ç«¯è‡ªåŠ¨é€‰æ‹©æ­£ç¡®çš„æ¥å£
- ç”¨æˆ·æ— éœ€å…³å¿ƒåº•å±‚å·®å¼‚
- ç»Ÿä¸€çš„è°ƒç”¨æ–¹å¼

### 3. æ˜“äºç»´æŠ¤
- ä»£ç é€»è¾‘æ¸…æ™°
- æ˜“äºæ‰©å±•æ–°å¸‚åœº
- å‡å°‘é‡å¤ä»£ç 

---

## å…«ã€æ³¨æ„äº‹é¡¹

### 1. æ¥å£é€‰æ‹©
- ç¾è‚¡å¿…é¡»ä½¿ç”¨ `inputIntegratedOrder`
- Aè‚¡/æ¸¯è‚¡å¿…é¡»ä½¿ç”¨ `inputOrder`
- å®¢æˆ·ç«¯å·²è‡ªåŠ¨å¤„ç†

### 2. å‚æ•°è¦æ±‚
- ç¾è‚¡éœ€è¦ `period_type` å‚æ•°
- Aè‚¡/æ¸¯è‚¡éœ€è¦ `security_type` å‚æ•°
- å®¢æˆ·ç«¯å·²è‡ªåŠ¨æ·»åŠ 

### 3. æ’¤å•å·®å¼‚
- ç¾è‚¡æ’¤å•éœ€è¦ `market_type` å‚æ•°
- Aè‚¡/æ¸¯è‚¡æ’¤å•ä¸éœ€è¦
- å®¢æˆ·ç«¯å·²è‡ªåŠ¨å¤„ç†

### 4. è´¦æˆ·é…ç½®
- å¿…é¡»ä¸ºæ¯ä¸ªå¸‚åœºé…ç½®ç‹¬ç«‹çš„è´¦æˆ·ID
- ä¸å†æ”¯æŒé»˜è®¤è´¦æˆ·é…ç½®
- æœªé…ç½®çš„å¸‚åœºæ— æ³•äº¤æ˜“

---

## ä¹ã€æ€»ç»“

âœ… **ç»Ÿä¸€çš„å‚æ•°**:
- ä¹°å…¥: `side=B`
- å–å‡º: `side=A`

âœ… **ä¸åŒçš„æ¥å£**:
- ç¾è‚¡: `inputIntegratedOrder` / `cancelIntegratedOrder`
- Aè‚¡/æ¸¯è‚¡: `inputOrder` / `cancelOrder`

âœ… **æ™ºèƒ½è·¯ç”±**:
- å®¢æˆ·ç«¯è‡ªåŠ¨é€‰æ‹©æ­£ç¡®çš„æ¥å£
- è‡ªåŠ¨æ·»åŠ å¿…éœ€çš„å‚æ•°
- ç»Ÿä¸€çš„ç”¨æˆ·API

ğŸ‰ **ç®€å•æ˜“ç”¨**:
ç”¨æˆ·åªéœ€å…³æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œæ— éœ€å…³å¿ƒåº•å±‚æ¥å£å·®å¼‚ï¼
