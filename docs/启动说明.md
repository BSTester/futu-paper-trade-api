# å¯åŠ¨è¯´æ˜

## Windows ç³»ç»Ÿå¯åŠ¨æ–¹å¼

### æ–¹å¼1ï¼šä½¿ç”¨ run.batï¼ˆæ¨èï¼Œæœ€ç®€å•ï¼‰

ç›´æ¥åŒå‡» `run.bat` æ–‡ä»¶å³å¯å¯åŠ¨æœåŠ¡ã€‚

```bash
run.bat
```

### æ–¹å¼2ï¼šä½¿ç”¨ start.batï¼ˆå¸¦ç¯å¢ƒæ£€æŸ¥ï¼‰

åŒå‡» `start.bat` æ–‡ä»¶ï¼Œä¼šè‡ªåŠ¨æ£€æŸ¥ç¯å¢ƒå¹¶å¯åŠ¨æœåŠ¡ã€‚

```bash
start.bat
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
- æ£€æŸ¥ Python æ˜¯å¦å®‰è£…
- æ£€æŸ¥ .env é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- æ£€æŸ¥ä¾èµ–åŒ…æ˜¯å¦å®‰è£…
- å¯åŠ¨ API æœåŠ¡

### æ–¹å¼3ï¼šä½¿ç”¨å‘½ä»¤è¡Œ

æ‰“å¼€å‘½ä»¤æç¤ºç¬¦æˆ– PowerShellï¼Œè¿›å…¥é¡¹ç›®ç›®å½•ï¼š

```bash
cd futu-paper-trade-api
python main.py
```

### æ–¹å¼4ï¼šä½¿ç”¨ Python ç›´æ¥è¿è¡Œ

```bash
python -m uvicorn main:app --host 0.0.0.0 --port 8000
```

---

## Linux/Mac ç³»ç»Ÿå¯åŠ¨æ–¹å¼

### æ–¹å¼1ï¼šç›´æ¥è¿è¡Œ

```bash
cd futu-paper-trade-api
python main.py
```

### æ–¹å¼2ï¼šä½¿ç”¨ uvicorn

```bash
uvicorn main:app --host 0.0.0.0 --port 8000
```

### æ–¹å¼3ï¼šåå°è¿è¡Œ

```bash
nohup python main.py > output.log 2>&1 &
```

---

## é¦–æ¬¡å¯åŠ¨å‰çš„å‡†å¤‡

### 1. å®‰è£…ä¾èµ–

```bash
# Windows
setup.bat

# Linux/Mac
pip install -r requirements.txt
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶å¹¶ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```bash
# Windows
copy .env.example .env

# Linux/Mac
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥é…ç½®ï¼š

```env
FUTU_COOKIE=your_cookie_here
ACCOUNT_ID_US=your_us_account_id
ACCOUNT_ID_HK=your_hk_account_id
ACCOUNT_ID_CN=your_cn_account_id
```

---

## éªŒè¯å¯åŠ¨æˆåŠŸ

### 1. æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º

å¯åŠ¨æˆåŠŸååº”è¯¥çœ‹åˆ°ï¼š

```
ğŸ“Š è´¦æˆ·æ˜ å°„é…ç½®:
   HK -> 9393
   US -> 16992013
   CN -> 3182575
ğŸš€ å¯Œé€”æ¨¡æ‹Ÿäº¤æ˜“APIæœåŠ¡å¯åŠ¨ä¸­...
ğŸ“ æœåŠ¡åœ°å€: http://0.0.0.0:8000
ğŸ“– APIæ–‡æ¡£: http://0.0.0.0:8000/docs
INFO:     Started server process
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000
```

### 2. è®¿é—® API æ–‡æ¡£

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š
- API æ–‡æ¡£: http://localhost:8000/docs
- å¤‡ç”¨æ–‡æ¡£: http://localhost:8000/redoc
- å¥åº·æ£€æŸ¥: http://localhost:8000/health

### 3. æµ‹è¯• API

```bash
# ä½¿ç”¨ curl æµ‹è¯•
curl http://localhost:8000/health

# åº”è¯¥è¿”å›
{"status":"healthy"}
```

---

## åœæ­¢æœåŠ¡

### Windows

åœ¨è¿è¡ŒæœåŠ¡çš„å‘½ä»¤çª—å£ä¸­ï¼š
- æŒ‰ `Ctrl + C` åœæ­¢æœåŠ¡
- æˆ–ç›´æ¥å…³é—­å‘½ä»¤çª—å£

### Linux/Mac

```bash
# å¦‚æœåœ¨å‰å°è¿è¡Œ
Ctrl + C

# å¦‚æœåœ¨åå°è¿è¡Œ
ps aux | grep main.py
kill <è¿›ç¨‹ID>
```

---

## å¸¸è§å¯åŠ¨é—®é¢˜

### 1. ç«¯å£è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯**:
```
Error: [Errno 10048] error while attempting to bind on address ('0.0.0.0', 8000)
```

**è§£å†³æ–¹æ¡ˆ**:

#### æ–¹æ³•1ï¼šæ›´æ”¹ç«¯å£
ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š
```env
API_PORT=8001
```

#### æ–¹æ³•2ï¼šå…³é—­å ç”¨ç«¯å£çš„ç¨‹åº
```bash
# Windows
netstat -ano | findstr :8000
taskkill /PID <è¿›ç¨‹ID> /F

# Linux/Mac
lsof -i :8000
kill -9 <è¿›ç¨‹ID>
```

### 2. æ¨¡å—æœªæ‰¾åˆ°

**é”™è¯¯ä¿¡æ¯**:
```
ModuleNotFoundError: No module named 'httpx'
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
pip install -r requirements.txt
```

### 3. .env æ–‡ä»¶æœªæ‰¾åˆ°

**é”™è¯¯ä¿¡æ¯**:
```
[WARNING] .env file not found
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# Windows
copy .env.example .env

# Linux/Mac
cp .env.example .env
```

ç„¶åç¼–è¾‘ `.env` æ–‡ä»¶å¡«å…¥é…ç½®ã€‚

### 4. Cookie æ— æ•ˆ

**é”™è¯¯ä¿¡æ¯**:
```
è·å–è´¦æˆ·ä¿¡æ¯å¤±è´¥: 401 Unauthorized
```

**è§£å†³æ–¹æ¡ˆ**:
é‡æ–°è·å– Cookie å¹¶æ›´æ–° `.env` æ–‡ä»¶ã€‚å‚è€ƒ [å¿«é€Ÿå¼€å§‹æŒ‡å—](./å¿«é€Ÿå¼€å§‹æŒ‡å—.md)

---

## å¼€å‘æ¨¡å¼å¯åŠ¨

### å¯ç”¨è‡ªåŠ¨é‡è½½

```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

ä»£ç ä¿®æ”¹åä¼šè‡ªåŠ¨é‡å¯æœåŠ¡ã€‚

### å¯ç”¨è°ƒè¯•æ¨¡å¼

```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export DEBUG=1  # Linux/Mac
set DEBUG=1     # Windows

python main.py
```

---

## ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### ä½¿ç”¨ Gunicorn (Linux/Mac)

```bash
pip install gunicorn
gunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000
```

### ä½¿ç”¨ Docker

```dockerfile
FROM python:3.9-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .

CMD ["python", "main.py"]
```

æ„å»ºå’Œè¿è¡Œï¼š
```bash
docker build -t futu-api .
docker run -p 8000:8000 --env-file .env futu-api
```

### ä½¿ç”¨ systemd (Linux)

åˆ›å»ºæœåŠ¡æ–‡ä»¶ `/etc/systemd/system/futu-api.service`:

```ini
[Unit]
Description=Futu Paper Trade API
After=network.target

[Service]
Type=simple
User=your_user
WorkingDirectory=/path/to/futu-paper-trade-api
Environment="PATH=/path/to/venv/bin"
ExecStart=/path/to/venv/bin/python main.py
Restart=always

[Install]
WantedBy=multi-user.target
```

å¯åŠ¨æœåŠ¡ï¼š
```bash
sudo systemctl daemon-reload
sudo systemctl start futu-api
sudo systemctl enable futu-api
```

---

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

| å˜é‡å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| API_HOST | 0.0.0.0 | æœåŠ¡ç›‘å¬åœ°å€ |
| API_PORT | 8000 | æœåŠ¡ç«¯å£ |
| FUTU_COOKIE | - | å¯Œé€”Cookieï¼ˆå¿…éœ€ï¼‰ |
| ACCOUNT_ID_US | - | ç¾è‚¡è´¦æˆ·ID |
| ACCOUNT_ID_HK | - | æ¸¯è‚¡è´¦æˆ·ID |
| ACCOUNT_ID_CN | - | Aè‚¡è´¦æˆ·ID |

### ä¿®æ”¹ç›‘å¬åœ°å€

åªå…è®¸æœ¬åœ°è®¿é—®ï¼š
```env
API_HOST=127.0.0.1
```

å…è®¸æ‰€æœ‰åœ°å€è®¿é—®ï¼š
```env
API_HOST=0.0.0.0
```

### ä¿®æ”¹ç«¯å£

```env
API_PORT=8080
```

---

## æ—¥å¿—æŸ¥çœ‹

### æ§åˆ¶å°æ—¥å¿—

æœåŠ¡è¿è¡Œæ—¶ä¼šåœ¨æ§åˆ¶å°è¾“å‡ºæ—¥å¿—ã€‚

### ä¿å­˜æ—¥å¿—åˆ°æ–‡ä»¶

```bash
# Windows
python main.py > logs.txt 2>&1

# Linux/Mac
python main.py > logs.txt 2>&1 &
```

---

## æ€§èƒ½ä¼˜åŒ–

### å¢åŠ å·¥ä½œè¿›ç¨‹

```bash
uvicorn main:app --workers 4 --host 0.0.0.0 --port 8000
```

### å¯ç”¨è®¿é—®æ—¥å¿—

```bash
uvicorn main:app --access-log --host 0.0.0.0 --port 8000
```

---

## å®‰å…¨å»ºè®®

1. **ä¸è¦æš´éœ²åˆ°å…¬ç½‘**: ä»…åœ¨æœ¬åœ°æˆ–å†…ç½‘ä½¿ç”¨
2. **å®šæœŸæ›´æ–° Cookie**: Cookie ä¼šè¿‡æœŸï¼Œéœ€è¦å®šæœŸæ›´æ–°
3. **ä¿æŠ¤ .env æ–‡ä»¶**: ä¸è¦æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
4. **ä½¿ç”¨ HTTPS**: ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨åå‘ä»£ç†é…ç½® HTTPS

---

## å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¯åŠ¨æœåŠ¡
python main.py

# å¯åŠ¨æœåŠ¡ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
uvicorn main:app --reload

# æµ‹è¯•è¿æ¥
curl http://localhost:8000/health

# æŸ¥çœ‹ API æ–‡æ¡£
# æµè§ˆå™¨è®¿é—®: http://localhost:8000/docs
```

---

**æ›´å¤šå¸®åŠ©è¯·æŸ¥çœ‹**: [å¿«é€Ÿå¼€å§‹æŒ‡å—](./å¿«é€Ÿå¼€å§‹æŒ‡å—.md) | [æ•…éšœæ’é™¤](./æ•…éšœæ’é™¤.md)
