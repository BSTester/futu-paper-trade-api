# 股票代码格式说明

## 概述

API 支持多种股票代码格式，系统会自动识别市场类型并标准化代码格式。

## 支持的格式

### 1. 纯数字/字母格式（推荐）

**港股**：
- `00700` - 腾讯控股
- `09988` - 阿里巴巴

**A股**：
- `600519` - 贵州茅台（上海）
- `000001` - 平安银行（深圳）
- `688xxx` - 科创板股票

**美股**：
- `AAPL` - 苹果
- `TSLA` - 特斯拉
- `NVDA` - 英伟达

### 2. 带后缀格式（也支持）

**港股**：
- `00700.HK` - 腾讯控股
- `09988.HKEX` - 阿里巴巴

**A股**：
- `600519.SH` - 贵州茅台（上海）
- `000001.SZ` - 平安银行（深圳）
- `600519.CN` - 通用A股后缀

**美股**：
- `AAPL.US` - 苹果
- `TSLA.NASDAQ` - 特斯拉
- `NVDA.NYSE` - 英伟达

## 自动识别规则

系统会根据以下规则自动识别市场类型：

1. **有后缀**：优先根据后缀判断
   - `.HK`, `.HKEX` → 港股
   - `.SH`, `.SZ`, `.CN` → A股
   - `.US`, `.NASDAQ`, `.NYSE` → 美股

2. **无后缀**：根据代码格式判断
   - 5位数字（如 `00700`）→ 港股
   - 6位数字（如 `600519`）→ A股
   - 包含字母（如 `AAPL`）→ 美股

## 内部处理

### 请求富途接口时的代码标准化

当向富途接口发送请求时，系统会自动将股票代码转换为纯数字/字母格式：

- `00700.HK` → `00700`
- `600519.SH` → `600519`
- `AAPL.US` → `AAPL`

这确保了与富途API的兼容性，因为富途接口只接受纯数字/字母格式的股票代码。

### 用户API接口

用户在调用API时可以使用任何支持的格式，系统会自动处理：

```bash
# 以下两种格式都可以
curl "http://localhost:8000/api/quote?stock_code=00700"
curl "http://localhost:8000/api/quote?stock_code=00700.HK"

# A股示例
curl "http://localhost:8000/api/quote?stock_code=600519"
curl "http://localhost:8000/api/quote?stock_code=600519.SH"

# 美股示例
curl "http://localhost:8000/api/quote?stock_code=AAPL"
curl "http://localhost:8000/api/quote?stock_code=AAPL.US"
```

## 适用接口

所有涉及股票代码的接口都支持这两种格式：

- `/api/quote` - 获取行情
- `/api/kline` - 获取K线数据
- `/api/technical-analysis` - 获取技术指标
- `/api/trade` - 交易（买入/卖出）
- `/api/cancel` - 撤单

## 最佳实践

1. **推荐使用纯格式**：虽然支持后缀格式，但推荐使用纯数字/字母格式（如 `00700`, `600519`, `AAPL`），这样更简洁。

2. **明确市场时使用后缀**：如果代码可能有歧义，使用后缀格式可以明确指定市场（如 `000001.SH` vs `000001.SZ`）。

3. **保持一致性**：在同一个应用中，建议保持代码格式的一致性。

## 注意事项

- 股票代码不区分大小写，系统会自动转换为大写
- 后缀部分也不区分大小写（`.hk` 和 `.HK` 效果相同）
- 系统会自动去除前后空格
